# 大前端：IoT

Web 应用的架构相比于一个物联网系统，无非就是多了一层硬件层以及可选的协调层。

![IoT 层级](./images/iot-layers.png)


这个硬件层决定了物联网应用比Web应用更加复杂。对于大部分的Web应用来说 ，客户端都是手机、电脑、平板这些设备，都有着强大的处理能力，不需要考虑一些额外的因素。

对于物联网应用来说，我们需要考虑设备上的MCU的处理能力，根据其处理能力和使用环境使用不同的通信协议，如我们在一些设备上需要使用CoAP协议。在一些设备上不具备网络功能，需要考虑借助于可以联网的协助层，并且还需要使用一些短距离的无线传输协议，如低功耗蓝牙、红外、Zigbee等等。

## 传统的物联网

我毕业的时候，选定的毕业论文是一篇关于物联网的论文——《基于 REST 服务的最小物联网系统设计》。它是一篇入门级的论文，但凡是有 CS 基础的人，再加上一些硬件知识，都能写出这样的论文。不过我们的是毕业设计，论文反而有些其次，毕竟能不能过是以实物为主的。因此毕业设计动不动就要烧个几百 RMB，还不算服务器费用。然而，对于我们这些学习硬件为主的专业来说，就不是如此。

这篇论文是之前参加比赛的作品论文的“最小化”，里面使用到的主要就是创建RESTful服务，而它甚至称不上是一种技术。在这个作品里：

 * 我们使用Python语言里的Django框架作为Web服务框架，使用Django REST Framework来创建RESTful服务。
 * 为了使用手机当控制器，我们还要用Java写一个Android应用。
 * 我们使用Raspberry Pi作为硬件端的协调层，用于连接网络，并传输控制信号给硬件。在最初的设计里，因为便宜，我们打算使用运行OpenWRT的路由器来当硬件端的控制器。
 * 我们在硬件端使用Arduino作为控制器，写起代码特别简单，可以让我们关注于业务。
 * 我们还使用了Zigbee模块Xbee及I2C作为连接不同Arduino模块的的介质。
 * 最后，我们还需要在网页上做一个图表来显示实时数据。

所有的这些，我们需要使用Python、Java、JavaScript、C、Arduino五种语言。而如果我们要写相应的iOS应用，我们还需要Objective-C。

而同样的：

我刚实习的时候（2013 年），项目里使用的是 Backbone，作为单页面应用框架的核心来打造 Web 应用。这时，我开始关注于 Node.js，使用它实现物联网应用的可能性。当时，已经有了物联网协议 MQTT 和 CoAP 相关的库，便照猫画虎地写了一个支持 HTTP、CoAP、WebSocket 和 MQTT 的物联网。由于，当时缺乏一些大型应用的开发经典，所以做得并不是很好，但是已经可以看到 JavaScript 在这方面的远景。

一年多后，Ionic 也还没推出正式版，便发现到了这个框架真的很棒——它自带了一系列的 UI 组件，还用 NgCordova 封装了一系列  Cordova 的插件。便开始使用 Ionic 写了一些移动应用，发现还挺顺手的。接着，便拿这个框架尝试写物联网应用，这需要一些原生的插件，如 BLE、MQTT。后来，我也写了一个简单的 CoAP 插件。

后来，我们不再需要编译 Node.js（早期，使用的是 Raspberry Pi 来运行 Node.js），就可以在 ARM 处理器上运行 Node.js。并且我们已经有 Tessel、Espruino、Kinoma Create、Ruff 这些可以直接运行 JavaScript 的开发板。三星还推出 IoT.js，可以让更多的嵌入式设备，直接使用 JavaScript 作为开发语言。

人们开始在硬件上使用 JavaScript 的原因有很多，如 Web 的开发人员是最多的，而 JavaScript 很容易上手。

## 嵌入式设备分类

### 两种前端类型

#### 嵌入式设备作为服务端

诸如 ESP32 或者 ESP8266，它们可以和传统的 Web 应用一样，托管前端应用。

#### 嵌入式设备作为服务端和客户端

如 Android 系统中的

Android Things 相似的还有 Microsoft 10 IoT、Raspberry Pi

### 嵌入式设备分类

 - 低资源受限设备，只能使用传统的编译型语言编写，如 C、C++、汇编，
 - 

#### 低资源受限设备：编译型语言

它们只能使用

#### 普通嵌入式设备：

Android 是用得最多的嵌入式系统，。

OpenWRT 是用得最广泛的嵌入式系统之一，

在某些资源受限的设备上，我们无法运行一个带着完整 JavaScript 引擎的 WebView——出于软件体积、运行内存等因素的限制，去除了这些特性。诸如 CSS 3 中的动画特性，会占用大量的运算资源，算去掉了相应的支持。

## 固件编写

### Johnny-Five

### IoT.js

## Be Professinoal

### Arduino 与 Processing

### ESP866/ESP32 与 Lua

### C 语言
